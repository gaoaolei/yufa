import threading

from rediscluster import RedisCluster
from threading import Thread
import time
nodes = [
    {
        'host': '172.31.24.21',
        'port': '7000'
    }
]
c = RedisCluster(startup_nodes=nodes, password='19e.com.cn')
# c.set('gaoaolei',"123",ex=4)
# for i in range(10000):
#     c.expire('luna_app:del:16396:activity_by_id_map_1:',0)
c.set('gao','111',ex=8)
while True:

    # if c.ttl('gao')<=5:
    #     c.expire('gao',1000)
    print(c.ttl('gao'))

# def run():
#     for i in range(1000000000):
#         c.set(f'gaoaolei{i}',
#               '124224324243231242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432341242243242432344',
#               ex=10)
#         print(i)
#         print(c.ttl('gaoaolei1'))
#
#     # a = list(range(20))
#     # def run():
#     #     for i in a:
#     #         a.remove(i)
#     #         time.sleep(0.5)
#     #         print(i)
#
#
# if __name__ == '__main__':
#     import threading
#     for i in range(200):
#         t = Thread(target=run, name="thread-" + str(i))
#         t.start()
#     print(threading.active_count())
#     # t.join()